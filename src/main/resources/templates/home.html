<!DOCTYPE html>
<html lang="bg" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª ‚Äì EventApp</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    </head>
<body class="landing">
<header class="landing-header">
    <div class="container topbar">
        <a class="brand" th:href="@{/}">EventApp</a>
        <nav class="nav">
            <a class="nav-link" th:href="@{/events}">–°—ä–±–∏—Ç–∏—è</a>
            <a class="nav-link" th:href="@{/admin/categories}" sec:authorize="hasRole('ADMIN')">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a>
            <a class="nav-link" th:href="@{/admin/users}" sec:authorize="hasRole('ADMIN')">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</a>
            <a class="nav-link" th:href="@{/logout}">–ò–∑—Ö–æ–¥</a>
        </nav>
    </div>
</header>

<main>
    <section class="hero slim-hero" style="padding: 60px 0 56px; position: relative; overflow: hidden;">
        <div class="hero-bg" style="position: absolute; inset: 0; height: 100%; background: radial-gradient(1100px 420px at 50% 0px, rgba(79, 70, 229, .18), rgba(79, 70, 229, 0) 65%), linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.05) 100%); pointer-events: none; z-index: 0;"></div>
        <div class="container hero-inner" style="position: relative; z-index: 1;">
            <div class="hero-badge reveal">–¢–≤–æ–µ—Ç–æ —Ç–∞–±–ª–æ</div>
            <h1 class="hero-title" th:text="${user != null ? '–ó–¥—Ä–∞–≤–µ–π, ' + user.username + '!' : '–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª'}" style="margin-bottom: 8px;">–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª</h1>
            <p class="hero-subtitle" style="margin-bottom: 32px;">–¢–≤–æ–∏—Ç–µ –∑–∞–ø–∏—Å–∞–Ω–∏ —Å—ä–±–∏—Ç–∏—è –∏ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏ –ø—Ä–µ–∂–∏–≤—è–≤–∞–Ω–∏—è</p>
            
            <div class="hero-stats" style="margin-bottom: 32px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; max-width: 500px; margin-left: auto; margin-right: auto;">
                <div class="stat reveal" style="background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 20px; text-align: center; transition: transform 0.2s ease;">
                    <div class="stat-num" style="font-weight: 800; font-size: 32px; color: #4f46e5; margin-bottom: 8px;" th:text="${#lists.size(createdEvents)}">0</div>
                    <div class="stat-label" style="color: var(--muted); font-size: 14px; font-weight: 600;">–æ—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞–Ω–∏ —Å—ä–±–∏—Ç–∏—è</div>
                </div>
                <div class="stat reveal" style="background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 20px; text-align: center; transition: transform 0.2s ease;">
                    <div class="stat-num" style="font-weight: 800; font-size: 32px; color: #4f46e5; margin-bottom: 8px;" th:text="${#lists.size(subscribedEvents)}">0</div>
                    <div class="stat-label" style="color: var(--muted); font-size: 14px; font-weight: 600;">–º–æ–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                </div>
            </div>

            <div class="hero-actions" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px; max-width: 1100px; margin-left: auto; margin-right: auto;">
                <div style="display: contents;">
                    <a class="action-card reveal" th:href="@{/profile}" style="background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-decoration: none; color: inherit; transition: all 0.2s ease; display: flex; align-items: flex-start; gap: 16px;">
                        <span style="font-size: 28px; flex-shrink: 0;">üë§</span>
                        <div>
                            <div style="font-weight: 700; font-size: 16px; margin-bottom: 6px;">–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª</div>
                            <div style="color: var(--muted); font-size: 13px; line-height: 1.4;">–†–µ–¥–∞–∫—Ç–∏—Ä–∞–π –¥–∞–Ω–Ω–∏—Ç–µ —Å–∏ –∏ —Å–ª–µ–¥–∏ –∏—Å—Ç–æ—Ä–∏—è—Ç–∞ –Ω–∞ —É—á–∞—Å—Ç–∏—è—Ç–∞.</div>
                        </div>
                    </a>
                    <a class="action-card reveal" th:href="@{/events}" style="background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-decoration: none; color: inherit; transition: all 0.2s ease; display: flex; align-items: flex-start; gap: 16px; border-color: var(--brand); box-shadow: 0 0 0 1px var(--brand);">
                        <span style="font-size: 28px; flex-shrink: 0;">üîç</span>
                        <div>
                            <div style="font-weight: 700; font-size: 16px; margin-bottom: 6px;">–û—Ç–∫—Ä–∏–π —Å—ä–±–∏—Ç–∏—è</div>
                            <div style="color: var(--muted); font-size: 13px; line-height: 1.4;">–†–∞–∑–≥–ª–µ–¥–∞–π –∫–∞–∫–≤–æ –ø—Ä–µ–¥—Å—Ç–æ–∏ –∏ —Å–µ –∑–∞–ø–∏—à–∏ —Å–∞–º–æ —Å –µ–¥–∏–Ω –∫–ª–∏–∫.</div>
                        </div>
                    </a>
                    <a class="action-card reveal" th:href="@{/events/new}" style="background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-decoration: none; color: inherit; transition: all 0.2s ease; display: flex; align-items: flex-start; gap: 16px; border-color: var(--brand); box-shadow: 0 0 0 1px var(--brand);">
                        <span style="font-size: 28px; flex-shrink: 0;">‚ûï</span>
                        <div>
                            <div style="font-weight: 700; font-size: 16px; margin-bottom: 6px;">–î–æ–±–∞–≤–∏ —Å—ä–±–∏—Ç–∏–µ</div>
                            <div style="color: var(--muted); font-size: 13px; line-height: 1.4;">–û—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞–π —Å–æ–±—Å—Ç–≤–µ–Ω–æ —Å—ä–±–∏—Ç–∏–µ –∏ –ø–æ–∫–∞–Ω–∏ —É—á–∞—Å—Ç–Ω–∏—Ü–∏.</div>
                        </div>
                    </a>
                </div>
                <div sec:authorize="hasRole('ADMIN')" style="display: contents;">
                    <a class="action-card reveal" th:href="@{/admin/categories}" style="background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-decoration: none; color: inherit; transition: all 0.2s ease; display: flex; align-items: flex-start; gap: 16px; border-color: rgba(100, 116, 139, 0.3);">
                        <span style="font-size: 28px; flex-shrink: 0;">üóÇÔ∏è</span>
                        <div>
                            <div style="font-weight: 700; font-size: 16px; margin-bottom: 6px;">–£–ø—Ä–∞–≤–ª—è–≤–∞–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
                            <div style="color: var(--muted); font-size: 13px; line-height: 1.4;">–û—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞–π –∫–∞—Ç–∞–ª–æ–≥–∞ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞ —Ü—è–ª–∞—Ç–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞.</div>
                        </div>
                    </a>
                    <a class="action-card reveal" th:href="@{/admin/users}" style="background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-decoration: none; color: inherit; transition: all 0.2s ease; display: flex; align-items: flex-start; gap: 16px; border-color: rgba(100, 116, 139, 0.3);">
                        <span style="font-size: 28px; flex-shrink: 0;">üë•</span>
                        <div>
                            <div style="font-weight: 700; font-size: 16px; margin-bottom: 6px;">–£–ø—Ä–∞–≤–ª—è–≤–∞–π –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</div>
                            <div style="color: var(--muted); font-size: 13px; line-height: 1.4;">–ü—Ä–µ–≥–ª–µ–∂–¥–∞–π –∏ —É–ø—Ä–∞–≤–ª—è–≤–∞–π —Ä–æ–ª–∏—Ç–µ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞.</div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <div class="container home-sections" style="margin-top: 48px;">
        <div class="card" style="margin-bottom: 32px; padding: 24px; background: linear-gradient(135deg, rgba(79, 70, 229, 0.05) 0%, rgba(79, 70, 229, 0.02) 100%); border: 1px solid rgba(79, 70, 229, 0.1);">
            <div style="display: flex; align-items: flex-start; gap: 12px; margin-bottom: 20px; padding: 16px; background: var(--card); border-radius: 12px; border: 1px solid var(--border);">
                <span style="font-size: 24px; flex-shrink: 0;">üí°</span>
                <div style="flex: 1;">
                    <div style="font-weight: 700; font-size: 15px; margin-bottom: 6px; color: #4f46e5;">–ü–æ–ª–µ–∑–Ω–∏ —Å—ä–≤–µ—Ç–∏</div>
                    <div style="color: var(--muted); font-size: 13px; line-height: 1.6;">
                        <p style="margin: 0 0 8px 0;">‚Ä¢ –ú–æ–∂–µ—à –¥–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞—à —Å—ä–±–∏—Ç–∏—è—Ç–∞ —Å–∏ –¥–æ—Ä–∏ —Å–ª–µ–¥ –∫–∞—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ —Å–∞ —Å–µ –∑–∞–ø–∏—Å–∞–ª–∏</p>
                        <p style="margin: 0 0 8px 0;">‚Ä¢ –ò–∑—Ç—Ä–∏–≤–∞–Ω–µ –Ω–∞ —Å—ä–±–∏—Ç–∏–µ —â–µ –ø—Ä–µ–º–∞—Ö–Ω–µ –∏ –≤—Å–∏—á–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</p>
                        <p style="margin: 0;">‚Ä¢ –ò–∑–ø–æ–ª–∑–≤–∞–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏—Ç–µ –∑–∞ –ø–æ-–ª–µ—Å–Ω–æ –æ—Ç–∫—Ä–∏–≤–∞–Ω–µ –æ—Ç –¥—Ä—É–≥–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="card" style="margin-bottom: 32px; padding: 24px;">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; flex-wrap: wrap; gap: 16px;">
                <div>
                    <h2 class="mt-0 reveal" style="margin: 0 0 8px 0; font-size: 24px; font-weight: 700;">–°—ä–±–∏—Ç–∏—è, –∫–æ–∏—Ç–æ –æ—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞—à</h2>
                    <p style="margin: 0; color: var(--muted); font-size: 14px;" class="reveal">–ü—Ä–µ–≥–ª–µ–∂–¥–∞–π –∏ —É–ø—Ä–∞–≤–ª—è–≤–∞–π —Å—ä–±–∏—Ç–∏—è—Ç–∞, –∫–æ–∏—Ç–æ —Å–∏ —Å—ä–∑–¥–∞–ª</p>
                </div>
                <a th:href="@{/events/new}" class="btn reveal" style="text-decoration: none; white-space: nowrap; background: #4f46e5; color: #fff;">
                    ‚ûï –î–æ–±–∞–≤–∏ —Å—ä–±–∏—Ç–∏–µ
                </a>
            </div>
            
            <div class="reveal" th:if="${param.updated}">
                <div class="alert alert-success" style="margin-bottom: 20px; padding: 12px 16px; border-radius: 8px; background: rgba(43, 214, 123, 0.1); border: 1px solid rgba(43, 214, 123, 0.3);">
                    <strong>‚úì –£—Å–ø–µ—Ö!</strong> –°—ä–±–∏—Ç–∏–µ—Ç–æ –±–µ—à–µ –æ–±–Ω–æ–≤–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ.
                </div>
            </div>
            <div class="reveal" th:if="${successMessage}">
                <div class="alert alert-success" style="margin-bottom: 20px; padding: 12px 16px; border-radius: 8px; background: rgba(43, 214, 123, 0.1); border: 1px solid rgba(43, 214, 123, 0.3);">
                    <strong th:text="${#strings.substring(successMessage, 0, 7)}">‚úì –£—Å–ø–µ—Ö!</strong> <span th:text="${#strings.substring(successMessage, 8)}">–£—Å–ø–µ—à–Ω–æ —Å–µ –æ—Ç–ø–∏—Å–∞—Ö—Ç–µ –æ—Ç —Å—ä–±–∏—Ç–∏–µ—Ç–æ.</span>
                </div>
            </div>
            <div class="reveal" th:if="${param.deleted}">
                <div class="alert alert-success" style="margin-bottom: 20px; padding: 12px 16px; border-radius: 8px; background: rgba(43, 214, 123, 0.1); border: 1px solid rgba(43, 214, 123, 0.3);">
                    <strong>‚úì –£—Å–ø–µ—Ö!</strong> –°—ä–±–∏—Ç–∏–µ—Ç–æ –±–µ—à–µ –∏–∑—Ç—Ä–∏—Ç–æ —É—Å–ø–µ—à–Ω–æ.
                </div>
            </div>
            <div class="reveal" th:if="${param.error == 'unauthorized'}">
                <div class="alert alert-error" style="margin-bottom: 20px; padding: 12px 16px; border-radius: 8px; background: rgba(100, 116, 139, 0.1); border: 1px solid rgba(100, 116, 139, 0.3);">
                    <strong>‚ö† –ì—Ä–µ—à–∫–∞:</strong> –ù—è–º–∞—à –ø—Ä–∞–≤–æ –¥–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞—à/–∏–∑—Ç—Ä–∏–≤–∞—à —Ç–æ–≤–∞ —Å—ä–±–∏—Ç–∏–µ.
                </div>
            </div>
            <div class="reveal" th:if="${param.error == 'notFound'}">
                <div class="alert alert-error" style="margin-bottom: 20px; padding: 12px 16px; border-radius: 8px; background: rgba(100, 116, 139, 0.1); border: 1px solid rgba(100, 116, 139, 0.3);">
                    <strong>‚ö† –ì—Ä–µ—à–∫–∞:</strong> –°—ä–±–∏—Ç–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–º–µ—Ä–µ–Ω–æ.
                </div>
            </div>
            
            <div class="reveal" th:if="${#lists.isEmpty(createdEvents)}" style="padding: 48px 24px; text-align: center; color: var(--muted);">
                <div style="font-size: 48px; margin-bottom: 16px;">üìÖ</div>
                <p style="margin: 0; font-size: 16px; font-weight: 600;">–í—Å–µ –æ—â–µ –Ω–µ —Å–∏ —Å—ä–∑–¥–∞–ª —Å—ä–±–∏—Ç–∏–µ</p>
                <p style="margin: 8px 0 0 0; font-size: 14px;">–ó–∞–ø–æ—á–Ω–∏ —Å –±—É—Ç–æ–Ω–∞ ‚Äû–î–æ–±–∞–≤–∏ —Å—ä–±–∏—Ç–∏–µ"</p>
            </div>
            
            <div class="events-grid" th:if="${!#lists.isEmpty(createdEvents)}" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                <article class="event-card reveal" th:each="event : ${createdEvents}" style="background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; transition: all 0.2s ease; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: 0; right: 0; width: 4px; height: 100%; background: #4f46e5; opacity: 0.6;"></div>
                    <div style="margin-bottom: 16px;">
                        <h3 style="margin: 0 0 12px 0; font-size: 20px; font-weight: 700; line-height: 1.3;" th:text="${event.name}">–ò–º–µ –Ω–∞ —Å—ä–±–∏—Ç–∏–µ—Ç–æ</h3>
                        <p style="margin: 0; color: var(--muted); font-size: 14px; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;" th:text="${event.description}">–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ</p>
                    </div>
                    <div class="meta" style="font-size: 13px; color: var(--muted); margin-bottom: 16px; line-height: 1.6;">
                        <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 8px;">
                            <span>üìÖ</span>
                            <span th:text="${event.startTime != null ? #temporals.format(event.startTime, 'dd.MM.yyyy HH:mm') : '–ù–∞—á–∞–ª–Ω–∞ –¥–∞—Ç–∞ TBA'}">–ù–∞—á–∞–ª–æ</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 8px;" th:if="${!#strings.isEmpty(event.categoryName)}">
                            <span>üè∑Ô∏è</span>
                            <span>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <strong th:text="${event.categoryName}" style="color: #4f46e5;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</strong></span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <span>üë•</span>
                            <span th:text="${event.capacity != null ? '–ö–∞–ø–∞—Ü–∏—Ç–µ—Ç: ' + event.capacity : '–ö–∞–ø–∞—Ü–∏—Ç–µ—Ç: –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω'}">–ö–∞–ø–∞—Ü–∏—Ç–µ—Ç</span>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; padding-top: 16px; border-top: 1px solid var(--border);">
                        <a th:href="@{/events/{eventId}/editform(eventId=${event.id})}" class="btn" style="padding: 10px 18px; font-size: 14px; text-decoration: none; flex: 1; text-align: center; min-width: 100px; background: #4f46e5; color: #fff;">
                            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π
                        </a>
                        <form th:action="@{'/events/' + ${event.id}}" method="post" style="margin: 0; flex: 1; min-width: 100px;">
                            <input type="hidden" name="_method" value="delete" />
                            <input type="hidden" name="redirect" value="home" />
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                            <button type="submit" class="btn" style="width: 100%; padding: 10px 18px; font-size: 14px; background: #64748b; color: #fff; border: none;">
                                üóëÔ∏è –ò–∑—Ç—Ä–∏–π
                            </button>
                        </form>
                    </div>
                </article>
            </div>
        </div>

        <div class="card" style="padding: 24px;">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; flex-wrap: wrap; gap: 16px;">
                <div>
                    <h2 class="mt-0 reveal" style="margin: 0 0 8px 0; font-size: 24px; font-weight: 700;">–°—ä–±–∏—Ç–∏—è, –∑–∞ –∫–æ–∏—Ç–æ —Å–∏ –∑–∞–ø–∏—Å–∞–Ω</h2>
                    <p style="margin: 0; color: var(--muted); font-size: 14px;" class="reveal">–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏ —Å—ä–±–∏—Ç–∏—è, –∑–∞ –∫–æ–∏—Ç–æ —Å–∏ —Å–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–ª</p>
                </div>
                <a th:href="@{/events}" class="btn reveal" style="text-decoration: none; white-space: nowrap; background: #4f46e5; color: #fff;">
                    üîç –û—Ç–∫—Ä–∏–π —Å—ä–±–∏—Ç–∏—è
                </a>
            </div>
            
            <div class="reveal" th:if="${param.unsubscribed}">
                <div class="alert alert-success" style="margin-bottom: 20px; padding: 12px 16px; border-radius: 8px; background: rgba(43, 214, 123, 0.1); border: 1px solid rgba(43, 214, 123, 0.3);">
                    <strong>‚úì –£—Å–ø–µ—Ö!</strong> –£—Å–ø–µ—à–Ω–æ —Å–µ –æ—Ç–ø–∏—Å–∞—Ö—Ç–µ –æ—Ç —Å—ä–±–∏—Ç–∏–µ—Ç–æ.
                </div>
            </div>
            <div class="reveal" th:if="${param.notSubscribed}">
                <div class="alert alert-info" style="margin-bottom: 20px; padding: 12px 16px; border-radius: 8px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3);">
                    <strong>‚Ñπ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> –ù–µ —Å—Ç–µ –∑–∞–ø–∏—Å–∞–Ω–∏ –∑–∞ —Ç–æ–≤–∞ —Å—ä–±–∏—Ç–∏–µ.
                </div>
            </div>
            <div class="reveal" th:if="${param.missing}">
                <div class="alert alert-error" style="margin-bottom: 20px; padding: 12px 16px; border-radius: 8px; background: rgba(100, 116, 139, 0.1); border: 1px solid rgba(100, 116, 139, 0.3);">
                    <strong>‚ö† –ì—Ä–µ—à–∫–∞:</strong> –°—ä–±–∏—Ç–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–º–µ—Ä–µ–Ω–æ.
                </div>
            </div>
            
            <div class="reveal" th:if="${#lists.isEmpty(subscribedEvents)}" style="padding: 48px 24px; text-align: center; color: var(--muted);">
                <div style="font-size: 48px; margin-bottom: 16px;">üé´</div>
                <p style="margin: 0; font-size: 16px; font-weight: 600;">–í—Å–µ –æ—â–µ –Ω–µ —Å–∏ —Å–µ –∑–∞–ø–∏—Å–∞–ª –∑–∞ —Å—ä–±–∏—Ç–∏–µ</p>
                <p style="margin: 8px 0 0 0; font-size: 14px;">–†–∞–∑–≥–ª–µ–¥–∞–π –Ω–∞–ª–∏—á–Ω–∏—Ç–µ –∏ —Å–µ –ø—Ä–∏—Å—ä–µ–¥–∏–Ω–∏</p>
            </div>
            
            <div class="events-grid" th:if="${!#lists.isEmpty(subscribedEvents)}" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                <article class="event-card reveal" th:each="event : ${subscribedEvents}" style="background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; transition: all 0.2s ease; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: #4f46e5; opacity: 0.6;"></div>
                    <div style="margin-bottom: 16px;">
                        <h3 style="margin: 0 0 12px 0; font-size: 20px; font-weight: 700; line-height: 1.3;" th:text="${event.name}">–ò–º–µ –Ω–∞ —Å—ä–±–∏—Ç–∏–µ—Ç–æ</h3>
                        <p style="margin: 0; color: var(--muted); font-size: 14px; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;" th:text="${event.description}">–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ</p>
                    </div>
                    <div class="meta" style="font-size: 13px; color: var(--muted); margin-bottom: 16px; line-height: 1.6;">
                        <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 8px;">
                            <span>üìÖ</span>
                            <span th:text="${event.startTime != null ? #temporals.format(event.startTime, 'dd.MM.yyyy HH:mm') : '–ù–∞—á–∞–ª–Ω–∞ –¥–∞—Ç–∞ TBA'}">–ù–∞—á–∞–ª–æ</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 8px;" th:if="${!#strings.isEmpty(event.categoryName)}">
                            <span>üè∑Ô∏è</span>
                            <span>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <strong th:text="${event.categoryName}" style="color: #4f46e5;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</strong></span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;" th:if="${!#strings.isEmpty(event.creatorName)}">
                            <span>üë§</span>
                            <span>–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä: <strong th:text="${event.creatorName}" style="color: #64748b;">–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</strong></span>
                        </div>
                    </div>
                    <div th:if="${event.ticketCode != null}" class="ticket-toggle">
                        <button type="button"
                                class="ticket-toggle-btn"
                                th:attr="data-target-id=${'ticket-collapse-' + event.id}"
                                aria-expanded="false">
                            <span>üéüÔ∏è –ü–æ–∫–∞–∂–∏ –±–∏–ª–µ—Ç–∞</span>
                            <span class="ticket-toggle-icon">‚ñº</span>
                        </button>
                        <div class="ticket-collapse"
                             th:id="${'ticket-collapse-' + event.id}"
                             aria-hidden="true">
                            <div class="ticket-card">
                                <div class="ticket-card-header">
                                    <div>
                                        <div class="ticket-card-title">–¢–≤–æ—è—Ç –±–∏–ª–µ—Ç</div>
                                        <div class="ticket-card-note">–ü–æ–∫–∞–∂–∏ –∫–æ–¥–∞ –Ω–∞ –≤—Ö–æ–¥–∞ –∏–ª–∏ –æ—Ç–≤–æ—Ä–∏ QR –∑–∞ –º–æ–º–µ–Ω—Ç–∞–ª–Ω–æ —Å–∫–∞–Ω–∏—Ä–∞–Ω–µ.</div>
                                    </div>
                                    <span class="ticket-code" th:text="${event.ticketCode}">0000-0000</span>
                                </div>
                                <div class="ticket-actions">
                                    <div class="ticket-actions-row">
                                        <button type="button"
                                                class="btn btn-primary"
                                                th:attr="data-ticket-code=${event.ticketCode},data-event-name=${event.name}"
                                                onclick="window.eventTicketModal && window.eventTicketModal.open(this)">
                                            üì≤ –ü–æ–∫–∞–∂–∏ QR
                                        </button>
                                        <a class="btn btn-secondary"
                                           th:href="@{'/tickets/' + ${event.ticketCode} + '/qr'}"
                                           download>
                                            ‚¨áÔ∏è –ò–∑—Ç–µ–≥–ª–∏ QR
                                        </a>
                                    </div>
                                    <form th:action="@{'/events/' + ${event.id} + '/subscriptions'}" method="post">
                                        <input type="hidden" name="_method" value="delete" />
                                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                                        <button type="submit" class="btn btn-secondary">
                                            üö´ –û—Ç–ø–∏—à–∏ —Å–µ
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="padding-top: 16px; border-top: 1px solid var(--border);" th:if="${event.ticketCode == null}">
                        <form th:action="@{'/events/' + ${event.id} + '/subscriptions'}" method="post" style="margin: 0;">
                            <input type="hidden" name="_method" value="delete" />
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                            <button type="submit" class="btn btn-secondary" style="width: 100%; padding: 10px 18px; font-size: 14px;">
                                üö´ –û—Ç–ø–∏—à–∏ —Å–µ
                            </button>
                        </form>
                    </div>
                </article>
            </div>
        </div>

        <div class="card" style="margin-top: 32px; padding: 24px; background: var(--card); border: 1px solid var(--border); border-radius: 12px;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                <div class="reveal">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                        <span style="font-size: 28px;">üìã</span>
                        <h3 style="margin: 0; font-size: 18px; font-weight: 700;">–ë—ä—Ä–∑–∏ —Å—Ç—ä–ø–∫–∏</h3>
                    </div>
                    <ul style="margin: 0; padding-left: 20px; color: var(--muted); font-size: 14px; line-height: 1.8;">
                        <li>–°—ä–∑–¥–∞–π –Ω–æ–≤–æ —Å—ä–±–∏—Ç–∏–µ</li>
                        <li>–†–∞–∑–≥–ª–µ–¥–∞–π –Ω–∞–ª–∏—á–Ω–∏—Ç–µ —Å—ä–±–∏—Ç–∏—è</li>
                        <li>–†–µ–¥–∞–∫—Ç–∏—Ä–∞–π –ø—Ä–æ—Ñ–∏–ª–∞ —Å–∏</li>
                    </ul>
                </div>
                <div class="reveal">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                        <span style="font-size: 28px;">‚ùì</span>
                        <h3 style="margin: 0; font-size: 18px; font-weight: 700;">–ß–µ—Å—Ç–æ –∑–∞–¥–∞–≤–∞–Ω–∏ –≤—ä–ø—Ä–æ—Å–∏</h3>
                    </div>
                    <div style="color: var(--muted); font-size: 14px; line-height: 1.8;">
                        <p style="margin: 0 0 10px 0;"><strong style="color: var(--text);">–ú–æ–≥–∞ –ª–∏ –¥–∞ —Å–µ –∑–∞–ø–∏—à–∞ –∑–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–æ —Å—ä–±–∏—Ç–∏–µ?</strong><br/>–ù–µ, –Ω–µ –º–æ–∂–µ—à –¥–∞ —Å–µ –∑–∞–ø–∏—à–µ—à –∑–∞ —Å—ä–±–∏—Ç–∏–µ, –∫–æ–µ—Ç–æ —Å–∏ —Å—ä–∑–¥–∞–ª.</p>
                        <p style="margin: 0;"><strong style="color: var(--text);">–ö–∞–∫ –º–æ–≥–∞ –¥–∞ –æ—Ç–ø–∏—à–∞ —Å–µ?</strong><br/>–ò–∑–ø–æ–ª–∑–≤–∞–π –±—É—Ç–æ–Ω–∞ "–û—Ç–ø–∏—à–∏ —Å–µ" –≤ —Å—ä–±–∏—Ç–∏–µ—Ç–æ –∏–ª–∏ –≤ —Å–ø–∏—Å—ä–∫–∞ –ø–æ-–¥–æ–ª—É.</p>
                    </div>
                </div>
                <div class="reveal">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                        <span style="font-size: 28px;">‚ö°</span>
                        <h3 style="margin: 0; font-size: 18px; font-weight: 700;">–ë—ä—Ä–∑–∏ –≤—Ä—ä–∑–∫–∏</h3>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <a th:href="@{/events}" style="color: #4f46e5; text-decoration: none; font-size: 14px; font-weight: 600;">üîç –û—Ç–∫—Ä–∏–π —Å—ä–±–∏—Ç–∏—è ‚Üí</a>
                        <a th:href="@{/events/new}" style="color: #4f46e5; text-decoration: none; font-size: 14px; font-weight: 600;">‚ûï –°—ä–∑–¥–∞–π –Ω–æ–≤–æ —Å—ä–±–∏—Ç–∏–µ ‚Üí</a>
                        <a th:href="@{/profile}" style="color: #4f46e5; text-decoration: none; font-size: 14px; font-weight: 600;">üë§ –ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª ‚Üí</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<th:block th:replace="~{fragments/footer :: siteFooter}"></th:block>

<script>
    const onReveal = (entries, observer) => {
        entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('revealed'); observer.unobserve(e.target);} });
    };
    const observer = new IntersectionObserver(onReveal, { threshold: 0.15 });
    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

    (function(){
        if (window.eventTicketModal) return;
        const modal = document.createElement('div');
        modal.className = 'ticket-modal-backdrop';
        modal.innerHTML = `
            <div class="ticket-modal-card" role="dialog" aria-modal="true" aria-labelledby="ticketModalTitle">
                <button type="button" class="ticket-modal-close" aria-label="–ó–∞—Ç–≤–æ—Ä–∏">‚úï</button>
                <div class="ticket-modal-body">
                    <p id="ticketModalSubtitle" class="ticket-modal-subtitle">–ë–∏–ª–µ—Ç</p>
                    <h2 id="ticketModalTitle" class="ticket-modal-title">–ü–æ–∫–∞–∂–∏ —Ç–æ–∑–∏ QR –∫–æ–¥ –ø—Ä–∏ –≤—Ö–æ–¥</h2>
                    <img id="ticketModalQr" class="ticket-modal-qr" alt="QR –∫–æ–¥" src="" />
                    <code id="ticketModalCode" class="ticket-modal-code">0000-0000</code>
                    <div class="ticket-modal-actions">
                        <a id="ticketModalDownload" class="btn btn-primary ticket-modal-download" download>‚¨áÔ∏è –ò–∑—Ç–µ–≥–ª–∏ QR</a>
                        <button type="button" id="ticketModalCopy" class="btn btn-secondary ticket-modal-copy">üìã –ö–æ–ø–∏—Ä–∞–π –∫–æ–¥–∞</button>
                    </div>
                </div>
            </div>`;
        document.body.appendChild(modal);

        const closeBtn = modal.querySelector('.ticket-modal-close');
        const qrImg = modal.querySelector('#ticketModalQr');
        const codeEl = modal.querySelector('#ticketModalCode');
        const subtitleEl = modal.querySelector('#ticketModalSubtitle');
        const downloadLink = modal.querySelector('#ticketModalDownload');
        const copyBtn = modal.querySelector('#ticketModalCopy');

        const closeModal = () => {
            modal.style.display = 'none';
            qrImg.src = '';
        };

        closeBtn.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
        document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && modal.style.display === 'flex') closeModal(); });

        copyBtn.addEventListener('click', async () => {
            const code = codeEl.textContent?.trim();
            if (!code) return;
            try {
                await navigator.clipboard.writeText(code);
                const original = copyBtn.textContent;
                copyBtn.textContent = '‚úÖ –ö–æ–ø–∏—Ä–∞–Ω–æ';
                setTimeout(() => { copyBtn.textContent = original; }, 2000);
            } catch (err) {
                console.error('Clipboard copy failed', err);
            }
        });

        window.eventTicketModal = {
            open(trigger) {
                if (!trigger) return;
                const code = trigger.getAttribute('data-ticket-code');
                if (!code) return;
                const eventName = trigger.getAttribute('data-event-name') || '';
                modal.style.display = 'flex';
                qrImg.src = `/tickets/${code}/qr`;
                qrImg.alt = `QR –∫–æ–¥ –∑–∞ –±–∏–ª–µ—Ç ${code}`;
                codeEl.textContent = code;
                subtitleEl.textContent = eventName ? `–ë–∏–ª–µ—Ç –∑–∞ ${eventName}` : '–ë–∏–ª–µ—Ç';
                downloadLink.href = `/tickets/${code}/qr`;
                closeBtn.focus();
            }
        };
    })();

    document.querySelectorAll('.ticket-toggle-btn').forEach(btn => {
        const targetId = btn.getAttribute('data-target-id');
        const collapse = targetId ? document.getElementById(targetId) : null;
        const icon = btn.querySelector('.ticket-toggle-icon');
        if (!collapse) return;
        btn.addEventListener('click', () => {
            const isOpen = collapse.classList.toggle('is-open');
            collapse.setAttribute('aria-hidden', (!isOpen).toString());
            btn.setAttribute('aria-expanded', isOpen.toString());
            if (icon) {
                icon.textContent = isOpen ? '‚ñ≤' : '‚ñº';
            }
        });
    });
</script>
</body>
</html>






