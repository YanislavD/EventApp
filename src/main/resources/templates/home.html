<!DOCTYPE html>
<html lang="bg" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª ‚Äì EventApp</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    </head>
<body class="landing">
<header class="landing-header">
    <div class="container topbar">
        <a class="brand" th:href="@{/}">EventApp</a>
        <nav class="nav">
            <a class="nav-link" th:href="@{/events}">–°—ä–±–∏—Ç–∏—è</a>
            <a class="nav-link" th:href="@{/admin/categories}" sec:authorize="hasRole('ADMIN')">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a>
            <a class="nav-link" th:href="@{/admin/users}" sec:authorize="hasRole('ADMIN')">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</a>
            <a class="nav-link" th:href="@{/logout}">–ò–∑—Ö–æ–¥</a>
            <button id="themeToggle" class="icon-btn" aria-label="–ü—Ä–µ–≤–∫–ª—é—á–∏ —Ç–µ–º–∞">üåì</button>
        </nav>
    </div>
</header>

<main>
    <section class="hero slim-hero">
        <div class="container hero-inner">
            <div class="hero-badge reveal">–¢–≤–æ–µ—Ç–æ —Ç–∞–±–ª–æ</div>
            <h1 class="hero-title" th:text="${user != null ? '–ó–¥—Ä–∞–≤–µ–π, ' + user.username : '–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª'}">–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª</h1>
            <p class="hero-subtitle">–¢–≤–æ–∏—Ç–µ –∑–∞–ø–∏—Å–∞–Ω–∏ —Å—ä–±–∏—Ç–∏—è –∏ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏ –ø—Ä–µ–∂–∏–≤—è–≤–∞–Ω–∏—è</p>
            <div class="hero-actions hero-actions-grid">
                <a class="action-card action-card-secondary reveal" th:href="@{/profile}">
                    <span class="action-icon">üë§</span>
                    <div>
                        <span class="action-title">–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª</span>
                        <span class="action-text">–†–µ–¥–∞–∫—Ç–∏—Ä–∞–π –¥–∞–Ω–Ω–∏—Ç–µ —Å–∏ –∏ —Å–ª–µ–¥–∏ –∏—Å—Ç–æ—Ä–∏—è—Ç–∞ –Ω–∞ —É—á–∞—Å—Ç–∏—è—Ç–∞.</span>
                    </div>
                </a>
                <a class="action-card action-card-primary reveal" th:href="@{/events}">
                    <span class="action-icon">üîç</span>
                    <div>
                        <span class="action-title">–û—Ç–∫—Ä–∏–π —Å—ä–±–∏—Ç–∏—è</span>
                        <span class="action-text">–†–∞–∑–≥–ª–µ–¥–∞–π –∫–∞–∫–≤–æ –ø—Ä–µ–¥—Å—Ç–æ–∏ –∏ —Å–µ –∑–∞–ø–∏—à–∏ —Å–∞–º–æ —Å –µ–¥–∏–Ω –∫–ª–∏–∫.</span>
                    </div>
                </a>
                <a class="action-card action-card-primary reveal" th:href="@{/events/create}">
                    <span class="action-icon">‚ûï</span>
                    <div>
                        <span class="action-title">–î–æ–±–∞–≤–∏ —Å—ä–±–∏—Ç–∏–µ</span>
                        <span class="action-text">–û—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞–π —Å–æ–±—Å—Ç–≤–µ–Ω–æ —Å—ä–±–∏—Ç–∏–µ –∏ –ø–æ–∫–∞–Ω–∏ —É—á–∞—Å—Ç–Ω–∏—Ü–∏.</span>
                    </div>
                </a>
                <a class="action-card action-card-secondary reveal" th:href="@{/admin/categories}" sec:authorize="hasRole('ADMIN')">
                    <span class="action-icon">üóÇÔ∏è</span>
                    <div>
                        <span class="action-title">–£–ø—Ä–∞–≤–ª—è–≤–∞–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</span>
                        <span class="action-text">–û—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞–π –∫–∞—Ç–∞–ª–æ–≥–∞ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞ —Ü—è–ª–∞—Ç–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞.</span>
                    </div>
                </a>
                <a class="action-card action-card-secondary reveal" th:href="@{/admin/users}" sec:authorize="hasRole('ADMIN')">
                    <span class="action-icon">üë•</span>
                    <div>
                        <span class="action-title">–£–ø—Ä–∞–≤–ª—è–≤–∞–π –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</span>
                        <span class="action-text">–ü—Ä–µ–≥–ª–µ–∂–¥–∞–π –∏ —É–ø—Ä–∞–≤–ª—è–≤–∞–π —Ä–æ–ª–∏—Ç–µ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞.</span>
                    </div>
                </a>
            </div>

            <div class="hero-stats">
                <div class="stat reveal">
                    <div class="stat-num" th:text="${#lists.size(createdEvents)}">0</div>
                    <div class="stat-label">–æ—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞–Ω–∏ —Å—ä–±–∏—Ç–∏—è</div>
                </div>
                <div class="stat reveal">
                    <div class="stat-num" th:text="${#lists.size(subscribedEvents)}">0</div>
                    <div class="stat-label">–º–æ–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                </div>
            </div>
        </div>
        <div class="hero-bg"></div>
    </section>

    <div class="container home-sections">
        <div class="card">
            <h2 class="mt-0 reveal">–°—ä–±–∏—Ç–∏—è, –∫–æ–∏—Ç–æ –æ—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞—à</h2>
            <div class="reveal" th:if="${param.updated}">
                <div class="alert alert-success" style="margin-bottom: 16px;">
                    <strong>–£—Å–ø–µ—Ö!</strong> –°—ä–±–∏—Ç–∏–µ—Ç–æ –±–µ—à–µ –æ–±–Ω–æ–≤–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ.
                </div>
            </div>
            <div class="reveal" th:if="${param.deleted}">
                <div class="alert alert-success" style="margin-bottom: 16px;">
                    <strong>–£—Å–ø–µ—Ö!</strong> –°—ä–±–∏—Ç–∏–µ—Ç–æ –±–µ—à–µ –∏–∑—Ç—Ä–∏—Ç–æ —É—Å–ø–µ—à–Ω–æ.
                </div>
            </div>
            <div class="reveal" th:if="${param.error == 'unauthorized'}">
                <div class="alert alert-error" style="margin-bottom: 16px;">
                    <strong>–ì—Ä–µ—à–∫–∞:</strong> –ù—è–º–∞—à –ø—Ä–∞–≤–æ –¥–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞—à/–∏–∑—Ç—Ä–∏–≤–∞—à —Ç–æ–≤–∞ —Å—ä–±–∏—Ç–∏–µ.
                </div>
            </div>
            <div class="reveal" th:if="${param.error == 'notFound'}">
                <div class="alert alert-error" style="margin-bottom: 16px;">
                    <strong>–ì—Ä–µ—à–∫–∞:</strong> –°—ä–±–∏—Ç–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–º–µ—Ä–µ–Ω–æ.
                </div>
            </div>
            <div class="reveal" th:if="${#lists.isEmpty(createdEvents)}">–í—Å–µ –æ—â–µ –Ω–µ —Å–∏ —Å—ä–∑–¥–∞–ª —Å—ä–±–∏—Ç–∏–µ. –ó–∞–ø–æ—á–Ω–∏ —Å –±—É—Ç–æ–Ω ‚Äû–î–æ–±–∞–≤–∏ —Å—ä–±–∏—Ç–∏–µ".</div>
            <div class="grid" th:if="${!#lists.isEmpty(createdEvents)}">
                <article class="feature-card reveal" th:each="event : ${createdEvents}">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; flex-wrap: wrap;">
                        <div style="flex: 1;">
                            <h3 style="margin: 0 0 8px 0;" th:text="${event.name}">–ò–º–µ –Ω–∞ —Å—ä–±–∏—Ç–∏–µ—Ç–æ</h3>
                            <p style="margin: 0 0 12px 0;" th:text="${event.description}">–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ</p>
                            <div class="meta">
                                <span th:text="${event.startTime != null ? #temporals.format(event.startTime, 'dd.MM.yyyy HH:mm') : '–ù–∞—á–∞–ª–Ω–∞ –¥–∞—Ç–∞ TBA'}">–ù–∞—á–∞–ª–æ</span>
                                <span th:if="${!#strings.isEmpty(event.categoryName)}">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <span th:text="${event.categoryName}">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</span></span>
                                <span th:text="${event.capacity != null ? '–ö–∞–ø–∞—Ü–∏—Ç–µ—Ç: ' + event.capacity : '–ö–∞–ø–∞—Ü–∏—Ç–µ—Ç: –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω'}">–ö–∞–ø–∞—Ü–∏—Ç–µ—Ç</span>
                            </div>
                        </div>
                        <div style="flex-shrink: 0; display: flex; gap: 8px; flex-wrap: wrap;">
                            <a th:href="@{/events/{eventId}/edit(eventId=${event.id})}" class="btn btn-primary" style="padding: 8px 16px; font-size: 0.875em; white-space: nowrap; text-decoration: none;">
                                –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π
                            </a>
                            <form th:action="@{/events/{eventId}/delete(eventId=${event.id})}" method="post" style="margin: 0; display: inline;">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                                <button type="submit" class="btn" style="padding: 8px 16px; font-size: 0.875em; white-space: nowrap; background: #dc3545; color: #fff; border: none; cursor: pointer;" onclick="return confirm('–°–∏–≥—É—Ä–µ–Ω –ª–∏ —Å–∏, —á–µ –∏—Å–∫–∞—à –¥–∞ –∏–∑—Ç—Ä–∏–µ—à —Ç–æ–≤–∞ —Å—ä–±–∏—Ç–∏–µ? –¢–æ–≤–∞ –¥–µ–π—Å—Ç–≤–∏–µ –µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.');">
                                    –ò–∑—Ç—Ä–∏–π
                                </button>
                            </form>
                        </div>
                    </div>
                </article>
            </div>
        </div>

        <div class="card">
            <h2 class="mt-0 reveal">–°—ä–±–∏—Ç–∏—è, –∑–∞ –∫–æ–∏—Ç–æ —Å–∏ –∑–∞–ø–∏—Å–∞–Ω</h2>
            <div class="reveal" th:if="${param.unsubscribed}">
                <div class="alert alert-success" style="margin-bottom: 16px;">
                    <strong>–£—Å–ø–µ—Ö!</strong> –£—Å–ø–µ—à–Ω–æ —Å–µ –æ—Ç–ø–∏—Å–∞—Ö—Ç–µ –æ—Ç —Å—ä–±–∏—Ç–∏–µ—Ç–æ.
                </div>
            </div>
            <div class="reveal" th:if="${param.notSubscribed}">
                <div class="alert alert-info" style="margin-bottom: 16px;">
                    <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> –ù–µ —Å—Ç–µ –∑–∞–ø–∏—Å–∞–Ω–∏ –∑–∞ —Ç–æ–≤–∞ —Å—ä–±–∏—Ç–∏–µ.
                </div>
            </div>
            <div class="reveal" th:if="${param.missing}">
                <div class="alert alert-error" style="margin-bottom: 16px;">
                    <strong>–ì—Ä–µ—à–∫–∞:</strong> –°—ä–±–∏—Ç–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–º–µ—Ä–µ–Ω–æ.
                </div>
            </div>
            <div class="reveal" th:if="${#lists.isEmpty(subscribedEvents)}">–í—Å–µ –æ—â–µ –Ω–µ —Å–∏ —Å–µ –∑–∞–ø–∏—Å–∞–ª –∑–∞ —Å—ä–±–∏—Ç–∏–µ. –†–∞–∑–≥–ª–µ–¥–∞–π –Ω–∞–ª–∏—á–Ω–∏—Ç–µ –∏ —Å–µ –ø—Ä–∏—Å—ä–µ–¥–∏–Ω–∏.</div>
            <div class="grid" th:if="${!#lists.isEmpty(subscribedEvents)}">
                <article class="feature-card reveal" th:each="event : ${subscribedEvents}">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; flex-wrap: wrap;">
                        <div style="flex: 1;">
                            <h3 style="margin: 0 0 8px 0;" th:text="${event.name}">–ò–º–µ –Ω–∞ —Å—ä–±–∏—Ç–∏–µ—Ç–æ</h3>
                            <p style="margin: 0 0 12px 0;" th:text="${event.description}">–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ</p>
                            <div class="meta">
                                <span th:text="${event.startTime != null ? #temporals.format(event.startTime, 'dd.MM.yyyy HH:mm') : '–ù–∞—á–∞–ª–Ω–∞ –¥–∞—Ç–∞ TBA'}">–ù–∞—á–∞–ª–æ</span>
                                <span th:if="${!#strings.isEmpty(event.categoryName)}">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <span th:text="${event.categoryName}">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</span></span>
                                <span th:if="${!#strings.isEmpty(event.creatorName)}">–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä: <span th:text="${event.creatorName}">–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</span></span>
                            </div>
                        </div>
                        <div style="flex-shrink: 0;">
                            <form th:action="@{'/events/' + ${event.id} + '/unsubscribe'}" method="post" style="margin: 0;">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                                <button type="submit" class="btn btn-secondary" style="padding: 8px 16px; font-size: 0.875em; white-space: nowrap;">
                                    –û—Ç–ø–∏—à–∏ —Å–µ
                                </button>
                            </form>
                        </div>
                    </div>
                </article>
            </div>
            <div class="reveal" style="margin-top:12px">
                <a class="btn" th:href="@{/events}">–û—Ç–∫—Ä–∏–π —Å—ä–±–∏—Ç–∏—è</a>
            </div>
        </div>
    </div>
</main>

<th:block th:replace="~{fragments/footer :: siteFooter}"></th:block>

<script>
    (function theme(){
        const btn = document.getElementById('themeToggle');
        if(!btn) return;
        const key = 'eventapp-theme';
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const saved = localStorage.getItem(key);
        const apply = (m)=>{ document.documentElement.dataset.theme = m; localStorage.setItem(key,m); };
        apply(saved || (prefersDark ? 'dark' : 'light'));
        btn.addEventListener('click', ()=> apply(document.documentElement.dataset.theme === 'dark' ? 'light' : 'dark'));
    })();

    const onReveal = (entries, observer) => {
        entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('revealed'); observer.unobserve(e.target);} });
    };
    const observer = new IntersectionObserver(onReveal, { threshold: 0.15 });
    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
</script>
</body>
</html>


